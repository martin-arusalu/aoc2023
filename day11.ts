const real =
  `........#..........................#...............#.....#..................................#..........................#....................
..............................................................................#.........................................................#...
............#..............................#....................#.........................................#.................................
................................#...........................................................................................................
....................................................................................................#........................#..............
..................#.....#.............................#..............................................................#......................
.....................................#..............................#......#....................#.......#...................................
...................................................................................#................................................#.......
.......#.....................#..................................#.............................................#.............................
..........................................................#............................#....................................................
#............................................#.....#.......................................................................#................
..................................#...........................................#.................................................#.........#.
........................#........................................................................#..........................................
....#.........#..........................................................................#..........................#.......................
..............................#...........#......................#..........................................................................
..................#.................#.......................................................................................................
...........#................................................................................................................................
......................................................#...................#...................#...................................#........#
............................#...............#...............................................................................................
....#................................................................................................#...............#........#.............
.....................................#...........#...........#...............#..........#..............................................#....
..............#......................................................#......................................#............#..................
.........#.....................................................................................#............................................
........................................................................................................#...................................
............................................................................................................................................
...#...........................................#..........................#.................................................................
.................................................................................................#..........................................
.............................#........................................................#....................#........#...........#...........
............#......#.....................#.........#................#.......................................................................
......................................................................................................#..................................#..
..............................................................#.............................................................................
.#........................#..............................................................#..................................................
.........#.........................................................................#...............#...............#...............#........
..................................#......................................#..................................................................
............................................#............#.......#.............................#............................................
............................#.......................#..........................................................#.......#.......#..........#.
.....#..................................................................................#...................................................
.................#.....................................................#..............................#.....................................
.........................................#.....#............#......................................................................#........
..........................................................................................................#.................................
.................................................................#.............#............................................................
.......................#.....#......................#......................................................................#................
.#...........#.........................#.....................................................#.........#.........................#..........
..................................................................................#..............................#..........................
.......#...................................................................#................................................................
................#..............#......................................................#...........#.....................#.............#.....
.........................#...................#.............................................................#...............................#
............................................................................................................................................
........................................#.....................................................................................#.............
....................#...............................................#........#........................#.....................................
......#....................#................................#...............................#.....................#.........................
.#..........................................................................................................................................
............................................................................................................................................
................#.............#...........#..........#............#....................................................#........#.....#.....
.....................................#...................................................#........#...........#.............................
....................#.........................................#............#................................................................
#.................................................#..................................#.....................................#................
............................................#................................................#.....................#........................
..................................#.................................................................................................#.......
.........#...............#..............#........................#............#..............................#..............................
..............................#.........................#.......................................#.....#.....................................
...............................................#.......................#....................................................................
.....................#......................................................................................................................
...............#...........................................................................................#................................
..#...................................#....................................#........................#............#.............#............
............................................#............................................#.............................................#....
...............................................................#............................................................................
........#.......................................................................................#..........................#................
..........................#.......#......................#....................#.............................................................
....#...........#.....................................................................................................#.....................
...................................................................#..............#...................#..........................#..........
..............................#..................................................................................#..........................
.............#......#........................................#.........#..........................#.........................................
.................................................#...................................#......................#............................#..
........#..............................................#....................................................................................
......................................#...................................#...................................................#.............
............................................................................................................................................
........................#.......................................................#.......................#...................................
........................................................................................................................#.........#.........
.......#....................................................................................................................................
.............................................................#.....#........................#......................#.......................#
#...........#.........................................................................#.....................................................
...................................................#............................................#..........................#.........#......
...................#................#....................................................................#.....#............................
............................................................................................................................................
..........................#............................#.......#.............................#..............................................
....#...................................#........#......................#.....#.............................................................
.....................................................................................................#.................#....................
............................................#................................................................#.....................#........
.........#.......................................................#...................#......................................................
............................................................................................................................................
................................#........................#.................#................................................................
..........................#.........................................#.......................................................#..............#
.#.................................................#.........#..............................................................................
..................#.................#.............................................#.........#...........#............#......................
.......................................................................................................................................#....
.........#..................#...............................................................................................................
............................................#........................................#.............................................#........
........................................................................#...................................................................
.#.................................................#..............#...........#............................#................................
....................#.................#.........................................................#.........................................#.
.............#.............................................................................#......................#........#................
...............................#......................................................................#..........................#..........
............................................................................................................................................
........................#................................................#..............#...................................................
........#.........................#......#.........#.........#..............................................................................
..................................................................#................#............................#...........................
..............................................................................................#.....#.......................................
.....#......................................................................#...............................................................
...................#.........................#........................................#..............................#..................#...
.#.........................#.............................#.......................................#................................#.........
............................................................................................................................................
................................................#........................#...................................................#..............
...........#............#.............................................................................#.....................................
..................................#................................#...........#....................................#.......................
#.........................................#....................................................#...............#............................
.............................#...........................................................................................................#..
.....#.......#.................................#.......................................#...........................................#........
........................................................................................................#...................#...............
...................................#.........................#..............................................................................
.........#...........................................................#.............#..............................#.........................
..................#........#.......................#....................................................................#......#........#...
........................................................................................#...........#.......................................
.................................#.......#..................................................................#...............................
.............#......................................................................................................................#.......
#.............................................................................#..................#..........................................
....................#................#.......................#.............................#............#...................................
....................................................................#...........................................#..........#.....#..........
...............................#.......................#...............................................................................#....
........#.......#...........................................................................................#...............................
........................#..................................................................................................................#
............................................................................................................................................
..............................................................................................#......................................#......
..........................................#..............................#...........#............................#.........................
............#.............#..................................#..........................................#.................#.................
........................................................................................................................................#...
...................#.......................................................................#................................................
#.................................#..................#.......................#..............................................................
.............................#......................................................................#.....#.....#...................#.......
......#........#.................................#............#......#......................................................................`;
const test = `...#......
.......#..
#.........
..........
......#...
.#........
.........#
..........
.......#..
#...#.....`;

function format(input: string) {
  return input.split("\n");
}

function part1(input: string) {
  console.time("part1");
  let result = 0;

  const data = format(input);

  function expand() {
    const expanded = [];
    const expColumns = [];

    for (let column = 0; column < data[0].length; column++) {
      if (data.every((e) => e.charAt(column) === ".")) {
        expColumns.push(column);
      }
    }
    for (let row = 0; row < data.length; row++) {
      let newRow = "";
      for (let col = 0; col < data[row].length; col++) {
        if (expColumns.indexOf(col) >= 0) {
          newRow += ".";
        }
        newRow += data[row].charAt(col);
      }

      expanded.push(newRow);
      if (!data[row].includes("#")) {
        expanded.push(newRow);
      }
    }

    return expanded;
  }

  const galaxies: Array<[number, number]> = [];
  const expanded = expand();
  for (let row = 0; row < expanded.length; row++) {
    const line = expanded[row];
    for (let col = 0; col < line.length; col++) {
      if (line.charAt(col) === "#") {
        galaxies.push([row, col]);
      }
    }
  }

  function distance(gal1: [number, number], gal2: [number, number]) {
    const [g1Row, g1Col] = gal1;
    const [g2Row, g2Col] = gal2;

    return Math.abs(g1Row - g2Row) + Math.abs(g1Col - g2Col);
  }

  galaxies.forEach((g1, g1Index) => {
    for (let g2Index = g1Index + 1; g2Index < galaxies.length; g2Index++) {
      const dist = distance(g1, galaxies[g2Index]);
      result += dist;
    }
  });

  console.log(result);
  console.timeEnd("part1");
}

function part2(input: string, multiplier: number) {
  console.time("part2");
  let result = 0;

  const data = format(input);

  function expand() {
    const expanded = [];
    const expColumns = [];

    for (let column = 0; column < data[0].length; column++) {
      if (data.every((e) => e.charAt(column) === ".")) {
        expColumns.push(column);
      }
    }
    for (let row = 0; row < data.length; row++) {
      let newRow = "";
      for (let col = 0; col < data[row].length; col++) {
        if (expColumns.indexOf(col) >= 0) {
          newRow += ".";
        }
        newRow += data[row].charAt(col);
      }

      expanded.push(newRow);
      if (!data[row].includes("#")) {
        expanded.push(newRow);
      }
    }

    return expanded;
  }

  function distance(gal1: [number, number], gal2: [number, number]) {
    const [g1Row, g1Col] = gal1;
    const [g2Row, g2Col] = gal2;

    return Math.abs(g1Row - g2Row) + Math.abs(g1Col - g2Col);
  }

  // get initial dist before expanding
  let galaxies: Array<[number, number]> = [];
  let initial = 0;
  let expanded = data;
  for (let row = 0; row < expanded.length; row++) {
    const line = expanded[row];
    for (let col = 0; col < line.length; col++) {
      if (line.charAt(col) === "#") {
        galaxies.push([row, col]);
      }
    }
  }

  galaxies.forEach((g1, g1Index) => {
    for (let g2Index = g1Index + 1; g2Index < galaxies.length; g2Index++) {
      const dist = distance(g1, galaxies[g2Index]);
      initial += dist;
    }
  });
  // get dist after 1
  galaxies = [];
  let after1 = 0;
  expanded = expand();
  for (let row = 0; row < expanded.length; row++) {
    const line = expanded[row];
    for (let col = 0; col < line.length; col++) {
      if (line.charAt(col) === "#") {
        galaxies.push([row, col]);
      }
    }
  }

  galaxies.forEach((g1, g1Index) => {
    for (let g2Index = g1Index + 1; g2Index < galaxies.length; g2Index++) {
      const dist = distance(g1, galaxies[g2Index]);
      after1 += dist;
    }
  });
  // get diff
  const diff = after1 - initial;
  // multiply diff by multiplier
  result = diff * (multiplier - 1);
  // add initial dist
  result += initial;

  console.log(result);
  console.timeEnd("part2");
}

part1(test);
part1(real);
part2(test, 10);
part2(test, 100);
part2(real, 1000000);
